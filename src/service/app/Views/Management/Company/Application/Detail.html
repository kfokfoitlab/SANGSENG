<?php
require_once(__DIR__."/../Sidebar.html");
?>

<section class="user-dashboard" id="user-resume">
  <div class="dashboard-outer">
    <div class="upper-title-box">
      <h3 title="채용 상세보기"><a>채용 상세보기</a></h3>
    </div>

    <form class="default-form">
    <div class="row">
      <div class="col-lg-12">

        <!-- Ls widget -->
        <div class="ls-widget">
          <div class="tabs-box">
            <div class="widget-title">
              <h3>모집요강</h3>
            </div>
            <div class="widget-content pb-4">
            <!-- {{{ -->
              <div class="row">
                <div class="form-group col-md-12">
                  <label><a>채용 제목</a></label>
                  <input type="text" name="title" title="이력서 제목" tabindex=100 value="<?=$data["title"]?>" disabled>
                </div>
                <div class="form-group col-md-12">
                  <label><a>상세 모집요강</a></label>
                  <div class="border py-3 px-2">
                    <?=nl2br($data["application_detail"])?>
                  </div>
                </div>
                <div class="form-group col-md-12">
                  <label><a>고용 형태</a></label>
                  <p class="mb-1 p-1" style="font-size: 1em; font-weight:bold">
                    <?php
                    if(@is_array($job_category["EmploymentType"]) && @count($job_category["EmploymentType"])){
                      foreach($job_category["EmploymentType"] as $val){
                        if($val["idx"] == $data["employment_type"]){
                          echo $val["title"];
                        }
                      }
                    }
                    ?>
                  </p>
                </div>
                <div class="form-group col-md-12">
                  <label><a>필요 경력 기간</a></label>
                  <p class="mb-1 p-1" style="font-size: 1em; font-weight:bold">
                    <?php
                    if(@is_array($job_category["Career"]) && @count($job_category["Career"])){
                      foreach($job_category["Career"] as $val){
                        if($val["idx"] == $data["career"]){
                          echo $val["title"];
                        }
                      }
                    }
                    ?>
                  </p>
                </div>
                <div class="form-group col-md-12">
                  <label><a>모집 인원</a></label>
                  <p class="mb-1 p-1" style="font-size: 1em; font-weight:bold">
                    <?=$data["recruitment_number"]?> 명
                  </p>
                </div>
                <div class="form-group col-md-12">
                  <label><a>직무 유형</a></label>
                  <p class="mb-1 p-1" style="font-size: 1em; font-weight:bold">
                    <?php
                    if(@is_array($job_category["Profession"]) && @count($job_category["Profession"])){
                      foreach($job_category["Profession"] as $val){
                        if($val["idx"] == $data["profession"]){
                          echo $val["title"];
                        }
                      }
                    }
                    ?>
                  </p>
                </div>
                <div class="form-group col-md-12 mb-2">
                  <label><a>담당 업무</a></label>
                  <div class="border py-3 px-2">
                    <?=nl2br($data["profession_detail"])?>
                  </div>
                </div>
                <div>
                  <label class="my-2"><a title="주소">근무 예정지</a></label>
                  <p class="mb-1 p-1" style="font-size: 1em; font-weight:bold">
                    우편번호: <?=$data["post_code"]?><br />
                    <?=$data["address"]?><br />
                    <?=$data["address_detail"]?>
                  </p>
                </div>
              </div>
            <!-- }}} -->
            </div>
          </div>
        </div>

        <!-- Ls widget -->
        <div class="ls-widget">
          <div class="tabs-box">
            <div class="widget-title">
              <h3>근무조건</h3>
            </div>
            <div class="widget-content pb-4">
            <!-- {{{ -->
              <div class="form-group col-md-12">
                <label><a>근무시간</a></label>
                <p class="mb-1 p-1" style="font-size: 1em; font-weight:bold">
                  <?php
                  if(@is_array($job_category["WorkType"]) && @count($job_category["WorkType"])){
                    foreach($job_category["WorkType"] as $val){
                      if($val["idx"] == $data["work_type"]){
                        echo $val["title"];
                      }
                    }
                  }
                  ?>
                </p>
                <div class="form-group mt-2">
                  <div class="border py-3 px-2">
                    <?=nl2br($data["work_type_detail"])?>
                  </div>
                </div>
              </div>
              <div class="form-group col-md-12">
                <label><a>임금</a></label>
                <p class="mb-1 p-1" style="font-size: 1em; font-weight:bold">
                  <?=$data["pay_type"]?> <?=number_format($data["pay_min"])?>원 ~ <?=number_format($data["pay_max"])?>원
                </p>
                <div class="form-group mt-2 ps-2">
                  <div class="input-group mb-2">
                  <input type="checkbox" name="pay_negotiability" value="y" id="pay_deal" title="임금 협의 가능" <?=($data["pay_negotiability"] == 1)?"checked":""?> disabled>
                    <label for="pay_deal"><a title="임금 협의 가능">임금 협의 가능</a></label>
                  </div>
                </div>
                <div class="form-group mb-0">
                  <div class="border py-3 px-2">
                    <?=nl2br($data["pay_detail"])?>
                  </div>
                </div>
              </div>
              <div class="form-group col-md-12">
                <label><a>사회보험</a></label>
                <div class="row ps-2">
                  <div class="col-6 col-md-3">
                    <div class="form-group mt-2 mb-0">
                      <div class="input-group mb-2">
                        <input type="checkbox" name="social_insurance_1" value="y" id="social_insurance_1" title="국민연금" <?=($data["social_insurance_1"] == 1)?"checked":""?> disabled>
                        <label for="social_insurance_1"><a title="국민연금">국민연금</a></label>
                      </div>
                    </div>
                  </div>
                  <div class="col-6 col-md-3">
                    <div class="form-group mt-2">
                      <div class="input-group mb-2">
                        <input type="checkbox" name="social_insurance_2" value="y" id="social_insurance_2" title="고용보험" <?=($data["social_insurance_2"] == 1)?"checked":""?> disabled>
                        <label for="social_insurance_2"><a title="고용보험">고용보험</a></label>
                      </div>
                    </div>
                  </div>
                  <div class="col-6 col-md-3">
                    <div class="form-group mt-2">
                      <div class="input-group mb-2">
                        <input type="checkbox" name="social_insurance_3" value="y" id="social_insurance_3" title="산재보험" <?=($data["social_insurance_3"] == 1)?"checked":""?> disabled>
                        <label for="social_insurance_3"><a title="산재보험">산재보험</a></label>
                      </div>
                    </div>
                  </div>
                  <div class="col-6 col-md-3">
                    <div class="form-group mt-2">
                      <div class="input-group mb-2">
                        <input type="checkbox" name="social_insurance_4" value="y" id="social_insurance_4" title="건강보험" <?=($data["social_insurance_4"] == 1)?"checked":""?> disabled>
                        <label for="social_insurance_4"><a title="건강보험">건강보험</a></label>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-group my-0">
                  <div class="border py-3 px-2">
                    <?=nl2br($data["insurance_detail"])?>
                  </div>
                </div>
              </div>
              <div class="form-group col-md-12">
                <label><a>퇴직급여</a></label>
                <div class="form-group mt-2 ps-2">
                  <div class="input-group mb-2">
                    <input type="checkbox" name="severance_pay" value="y" id="severance_pay" title="퇴직금" <?=($data["severance_pay"] == 1)?"checked":""?> disabled>
                    <label for="severance_pay"><a title="퇴직금">퇴직금</a></label>
                  </div>
                </div>
                <div class="form-group my-0">
                  <div class="border py-3 px-2">
                    <?=nl2br($data["severance_pay_detail"])?>
                  </div>
                </div>
              </div>
            <!-- }}} -->
            </div>
          </div>
        </div>

        <!-- Ls widget -->
        <div class="ls-widget">
          <div class="tabs-box">
            <div class="widget-title">
              <h3>전형방법</h3>
            </div>
            <div class="widget-content pb-4">
            <!-- {{{ -->
              <div class="form-group col-md-12">
                <label><a>접수 마감일</a></label>
                <p class="mb-1 p-1" style="font-size: 1em; font-weight:bold">
                  <?=$data["receipt_expire_date"]?>
                </p>
              </div>
              <div class="form-group col-md-12">
                <label><a>전형방법</a></label>
                <div class="row ps-2">
                  <div class="col-6 col-md-3">
                    <div class="form-group mt-2 mb-0">
                      <div class="input-group mb-2">
                        <input type="checkbox" name="receipt_method_doc" value="y" id="receipt_method_doc" title="서류" <?=($data["receipt_method_doc"] == 1)?"checked":""?> disabled>
                        <label for="receipt_method_doc"><a title="서류">서류</a></label>
                      </div>
                    </div>
                  </div>
                  <div class="col-6 col-md-3">
                    <div class="form-group mt-2">
                      <div class="input-group mb-2">
                        <input type="checkbox" name="receipt_method_interview" value="y" id="receipt_method_interview" title="면접" <?=($data["receipt_method_interview"] == 1)?"checked":""?> disabled>
                        <label for="receipt_method_interview"><a title="면접">면접</a></label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-group col-md-12">
                <label><a>추가 지원방법 안내</a></label>
                <div class="border py-3 px-2">
                  <?=nl2br($data["receipt_method_detail"])?>
                </div>
              </div>
            <!-- }}} -->
            </div>
          </div>
        </div>

        <!-- Ls widget -->
        <div class="ls-widget">
          <div class="tabs-box">
            <div class="widget-title">
              <h3>작업환경</h3>
            </div>
            <div class="widget-content pb-4">
            <!-- {{{ -->
              <div class="form-group">
                <label class="my-2" title="작업환경"><a>운동능력 조건</a></label>
                <table class="table table-hover table-borderless">
                <?php
                foreach($impairments["PhysicalAbility"] as $code => $items){
                ?>
                  <tr>
                    <th width=35% class="px-3 font-weight-400" title="<?=$items[0]["title"]?>"><a><?=$items[0]["title"]?></a></th>
                    <td class="px-3">
                      <div class="input-group mb-2">
                        <input type="radio" name="impairment[physical_ability][<?=$code?>]" value="null" id="impairment_physical_ability_<?=$code?>_null" title="조건없음" checked disabled>
                        <label for="impairment_physical_ability_<?=$code?>_null"><a tabindex=100 title="조건없음">조건없음</a></label>
                      </div>
                      <?php
                      foreach($items as $key => $val){
                        $checked = ($val["score"] == $impairment_data["physical_ability"][$code])?"checked":"";
                      ?>
                      <div class="input-group mb-2">
                        <input type="radio" name="impairment[physical_ability][<?=$code?>]" value="<?=$val["score"]?>" id="impairment_physical_ability_<?=$code."_".$key?>" title="<?=$val["item"]?>" <?=$checked?> disabled>
                        <label for="impairment_physical_ability_<?=$code."_".$key?>"><a tabindex=100 title="<?=$val["item"]?>"><?=$val["item"]?></a></label>
                      </div>
                      <?php
                      }
                      ?>
                    </td>
                  </tr>
                <?php
                }
                ?>
                </table>
              </div>
            <!-- }}} -->
            </div>
          </div>
        </div>

        <!-- Ls widget -->
        <div class="ls-widget">
          <div class="tabs-box">
            <div class="widget-title">
              <h3>우대사항</h3>
            </div>
            <div class="widget-content pb-4">
            <!-- {{{ -->
              <div class="form-group col-md-12">
                <label><a>우대사항</a></label>
                <div class="border py-3 px-2">
                  <?=nl2br($data["preference_detail"])?>
                </div>
              </div>
              <div class="form-group col-md-12">
                <label><a>추가조건</a></label>
                <div class="border py-3 px-2">
                  <?=nl2br($data["additional_condition_detail"])?>
                </div>
              </div>
            </div>
            <!-- }}} -->
          </div>
        </div>

        <!-- Ls widget -->
        <div class="ls-widget">
          <div class="tabs-box">
            <div class="widget-title">
              <h3>복리후생</h3>
            </div>
            <div class="widget-content pb-4">
            <!-- {{{ -->
              <div class="form-group col-md-12">
                <label><a>복리후생</a></label>
                <div class="row ps-2">
                <?php
                $welfare = json_decode($data["welfare"], true);
                if(@is_array($job_category["Welfare"]) && @count($job_category["Welfare"])){
                  foreach($job_category["Welfare"] as $val){
                    $checked = (array_search($val["idx"], $welfare) !== false)? "checked": "";
                ?>
                  <div class="col-6 col-md-3">
                    <div class="form-group mt-2 mb-0">
                      <div class="input-group mb-2">
                        <input type="checkbox" name="welfare[]" value="<?=$val["idx"]?>" id="welfare_<?=$val["idx"]?>" title="<?=$val["title"]?>" <?=$checked?> disabled>
                        <label for="welfare_<?=$val["idx"]?>"><a title="<?=$val["title"]?>"><?=$val["title"]?></a></label>
                      </div>
                    </div>
                  </div>
                  <?php
                  }
                }
                ?>
                </div>
              </div>
              <div class="form-group mt-2">
                <label><a>기타 복리후생</a></label>
                <div class="border py-3 px-2">
                  <?=nl2br($data["welfare_detail"])?>
                </div>
              </div>
            <!-- }}} -->
            </div>
          </div>
        </div>

        <!-- Ls widget -->
        <div class="ls-widget">
          <div class="tabs-box">
            <div class="widget-title">
              <h3>지원자 목록</h3>
            </div>
            <div class="widget-content pb-4">
            <!-- {{{ -->
              <div class="table-outer">
                <table class="default-table manage-job-table">
                  <thead>
                    <tr>
                      <th>지원자명</th>
                      <th>지원서 제목</th>
                      <th class="text-center" width="196">작성일</th>
                      <th class="text-center" width="128">상태</th>
                      <th class="text-center" width="56">보기</th>
                    </tr>
                  </thead>

                  <tbody>
                  <?php
                  if(@is_array($application_data) && count($application_data) > 0){
                    foreach($application_data as $item){
                  ?>
                    <tr>
                      <td>
                        <?=$item["user_name"]?>
                      </td>
                      <td>
                        <!-- Job Block -->
                        <div class="job-block">
                          <div class="inner-box">
                            <div class="content ps-0">
                              <h4><a tabindex=200><?=$item["title"]?></a></h4>
                              <ul class="job-info">
                                <li><span class="icon flaticon-briefcase"></span> <a><?=$item["profession_title"]?></a></li>
                                <li><span class="icon flaticon-clock-2"></span> <a><?=$item["employment_type_title"]?></a></li>
                                <li><span class="icon flaticon-money"></span> <a><?=$item["category_pay_type"]?> <?=number_format($item["category_pay"])?>원</a></li>
                              </ul>
                            </div>
                          </div>
                        </div>
                      </td>
                      <td><?=substr($item["register_date"], 0, 10)?></td>
                      <td>
                        <?php
                        switch($item["status"]){
                          case "1": echo "지원중"; break;
                          case "5": echo "채용됨"; break;
                          case "9": echo "탈락"; break;
                            
                        }
                        ?>
                      </td>
                      <td>
                        <a href="/<?=_CONTROLLER?>/DetailReceipt/<?=$item["application_uuid"]?>/<?=$item["resume_uuid"]?>/<?=$item["user_uuid"]?>" target="_blank" class="theme-btn btn-style-three px-2" tabindex=200>상세보기</a>
                      </td>
                    </tr>
                  <?php
                    }
                  }
                  ?>
                  </tbody>
                </table>
              </div>

            <!-- }}} -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <div>
      <a href="/<?=_CONTROLLER?>/Update/<?=$data["uuid"]?>" class="btn btn-primary px-4" tabindex=100>수정하기</a>
      <a href="/<?=_CONTROLLER?>/CloseSubmit/<?=$data["uuid"]?>" class="btn btn-info px-4 text-white" tabindex=100 onclick="return confirm('채용을 마감하시겠습니까?')">채용 마감하기</a>
      <a href="/<?=_CONTROLLER?>/" class="btn btn-dark px-4 ms-2 float-end" tabindex=100>목록으로</a>
      <a href="/<?=_CONTROLLER?>/DeleteSubmit/<?=$data["uuid"]?>" class="btn btn-outline-danger px-4 float-end" tabindex=100 onclick="return confirm('삭제하시겠습니까?')">삭제하기</a>
    </div>

    </form>
  </div>
</section>

