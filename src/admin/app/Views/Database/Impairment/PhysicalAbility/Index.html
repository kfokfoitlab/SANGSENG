<section class="content-main">
	<div class="content-header">
    <h2 class="content-title"> <?=$page_name?> </h2>
	</div>

  <form name="form-submit" method="POST" target="_self" action="/<?=_CONTROLLER?>/UpdateSubmit">
    <input type="hidden" name="json_data" value="">
  </form>


  <div class="card border rounded-lg">
    <div class="card-header" style="background-color:#f4f4f4; border:solid 1px #eee;">
      <div class="border-start border-4 border-warning ps-2 py-1">
        <h6 class="h6">
          <i class="text-warning icon material-icons md-report_problem" style=""></i>
          안내
        </h6>
        <ul class="small">
          <li>페이지 진입시 표출된 정보가 저장된 데이터 입니다.</li>
          <li>초기 상태로 되돌리려면 페이지 새로고침을 해 주세요.</li>
          <li>하단의 [저장하기] 버튼을 클릭하기 전까지 정보는 저장되지 않습니다.</li>
          <li>[저장하기] 버튼 클릭시 현재 설정하신 데이터로 저장합니다.</li>
          <li class="text-danger">코드번호 변경에 유의하세요. 이미 등록된 데이터와 코드번호는 밀접한 관계를 가지고 있습니다.</li>
          <li class="text-danger">코드번호는 영문과 숫자만 허용합니다.</li>
          <li class="text-danger">코드번호는 대소문자를 구분하지 않고, 항상 대문자로 자동 변환하여 저장됩니다.</li>
        </ul>
      </div>
    </div>
    <div class="card-body">
      <table class="table table-hover" id="data-table">
        <thead>
        <tr>
          <th width=48>순서</th>
          <th width=15%>코드번호</th>
          <th width=35%>제목</th>
          <th>항목</th>
        </tr>
        </thead>
        <tbody class="sortable">
        <?php
        if(@is_array($data) && count($data) > 0){
          foreach($data as $code => $items){
        ?>
        <tr class="lists" valign=top>
          <td class="handle" align=center valign=top><span class="material-icons-outlined"> more_vert </span></td>
          <td class="code" valign=top>
            <input type="text" class="form-control form-control-sm" pattern="^[a-zA-Z0-9]+$" name="code" placeholder="코드번호" value="<?=$code?>" required>
          </td>
          <td class="title" valign=top>
            <input type="text" class="form-control form-control-sm" name="title" placeholder="제목" value="<?=$items["title"]?>">
            <div class="text-end">
              <button class="btn btn-sm btn-outline-danger mt-1 action-remove-title">삭제</button>
            </div>
          </td>
          <td class="item" valign=top>
            <?php
            if(@is_array($items["items"]) && count($items["items"]) > 0){
              foreach($items["items"] as $key => $item){
            ?>
            <div class="input-group mb-1">
              <input type="text" class="form-control form-control-sm" name="item" placeholder="신규 항목명 입력" value="<?=$item["item"]?>">
              <div style="width:172px;">
                <input type="number" class="form-control form-control-sm" name="score" placeholder="중증도 점수: 기본 10" min=0 data-default=10 value="<?=$item["score"]?>">
              </div>
              <button type="button" class="btn btn-sm btn-outline-danger action-remove-item">삭제</button>
            </div>
            <?php
              }
            }?>
            <form name="add-item">
              <div class="input-group">
                <input type="text" class="form-control form-control-sm" name="new_item" placeholder="추가할 신규 항목명 입력" required>
                <div style="width:172px;">
                  <input type="number" class="form-control form-control-sm" name="new_score" placeholder="중증도 점수: 기본 10" min=0 data-default=10>
                </div>
                <button type="submit" class="btn btn-sm btn-success action-add-new-item">추가</button>
              </div>
            </form>
          </td>
        </tr>
        <?php
          }
        }?>
        </tbody>
      </table>

      <form name="add-title">
      <table class="table table-sm table-borderless mt-4">
        <tbody>
        <tr class="new">
          <td width=48 align=center valign=top></td>
          <td width=15% align=center valign=top>
            <input type="text" class="form-control form-control-sm" pattern="^[a-zA-Z0-9]+$" name="new_code" placeholder="신규 코드번호" required>
          </td>
          <td width=35% valign=top>
            <div class="input-group">
              <input type="text" class="form-control form-control-sm" name="new_title" placeholder="추가할 신규 제목을 입력" required>
              <button type="submit" class="btn btn-sm btn-success action-add-new-title">추가</button>
            </div>
          </td>
          <td></td>
        </tr>
        </tbody>
      </table>
      </form>
    </div>

    <div class="card-footer border-top">
      <button type="button" class="btn btn-primary action-save-submit">저장하기</button>
    </div>
  </div>

</section>


<!-- template -->
<div class="d-none" id="template-title">
  <table><tbody>
  <tr class="lists">
    <td class="handle" align=center valign=top><span class="material-icons-outlined"> more_vert </span></td>
    <td class="code" valign=top>
      <input type="text" class="form-control form-control-sm" pattern="^[a-zA-Z0-9]+$" name="code" placeholder="코드번호 입력" required>
    </td>
    <td class="title" valign=top>
      <input type="text" class="form-control form-control-sm" name="title" value="" placeholder="제목 입력" required>
      <div class="text-end">
        <button class="btn btn-sm btn-outline-danger mt-1 action-remove-title">삭제</button>
      </div>
    </td>
    <td class="item" valign=top>
      <form name="add-item">
        <div class="input-group">
          <input type="text" class="form-control form-control-sm" name="new_item" placeholder="추가할 신규 항목명 입력" required>
          <div style="width:172px;">
            <input type="number" class="form-control form-control-sm" name="new_score" placeholder="중증도 점수: 기본 10" min=0 data-default=10>
          </div>
          <button type="submit" class="btn btn-sm btn-success action-add-new-item">추가</button>
        </div>
      </form>
    </td>
  </tr>
  </tbody></table>
</div>

<div class="d-none" id="template-item">
  <div class="input-group">
    <input type="text" class="form-control form-control-sm" name="item" placeholder="신규 항목명 입력">
    <div style="width:172px;">
      <input type="number" class="form-control form-control-sm" name="score" placeholder="중증도 점수: 기본 10" min=0 data-default=10>
    </div>
    <button type="button" class="btn btn-sm btn-outline-danger action-remove-item">삭제</button>
  </div>
</div>
