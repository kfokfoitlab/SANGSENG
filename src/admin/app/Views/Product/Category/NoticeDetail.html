<div class="flex-grow-1 bg-light">
  <section class="p-5 mb-5">
    <div class="auto-container">
      <div class="bg-white p-5">
        <h4 class="fw-bold mb-4 pb-3 border-bottom border-2">공지사항 상세보기</h4>
        <form id="info_form" method="post" action="/<?=_CONTROLLER?>/noticeUpdate" enctype="multipart/form-data">
          <input type="hidden" name="idx" value="<?=$idx?>">

          <div class="row mb-3 align-items-center">
            <span class="col-2 fw-bold">공지 노출여부</span>
            <div class="col-10 d-flex">
              <label class="form-check-label me-3" for="flexCheck01">
                <input class="form-check-input" type="radio" value="1" id="flexCheck01" name="board_status"
                <?php if($board_status == 1){echo "checked";}?>>
                노출
              </label>
              <label class="form-check-label me-3" for="flexCheck02">
                <input class="form-check-input" type="radio" value="2" id="flexCheck02" name="board_status"
                <?php if($board_status == 2){echo "checked";}?>>
                미노출
              </label>
            </div>
          </div>

          <div class="row mb-3 align-items-center">
            <div class="col-2">
              <label for="title" class="form-label m-0 fw-bold">제목</label>
            </div>
            <div class="col-10">
              <input type="text" class="form-control" id="title" name="title" value="<?=$title?>">
            </div>
          </div>

          <div class="row mb-3 align-items-center">
            <div class="col-2">
              <label for="upload_file" class="form-label m-0 fw-bold">첨부파일</label>
            </div>
            <div class="col-10">
              <div class="d-flex">
                <button class="btn btn-outline-primary me-3" type="button" onclick="downloadFileNew('<?=$upload_file?>','<?=$upload_file_ori?>');">기존파일
                  다운로드
                </button>
                <button class="btn btn-outline-warning" type="button" id="uploadOn">파일수정</button>
                <input type="hidden" name="upload_file_ori_name" value='<?=$upload_file?>'>
                <input type="hidden" name="upload_file_ori" value='<?=$upload_file_ori?>'>
              </div>
              <input class="form-control" style="margin-top: 5px;" type="file" id="upload_file" name="upload_file"
                     value="">
            </div>
          </div>

          <div class="row mb-3 align-items-center">
            <span class="col-2 fw-bold">공지내용</span>
            <div class="col-10">
              <label class="visually-hidden" for="content">공지내용</label>
              <textarea class="form-control" style="height: 300px;resize: none;" id="content"
                        name="content"><?=$content?></textarea>
            </div>
          </div>

          <div class="mt-5 d-flex justify-content-between">
            <div>
              <button class="btn btn-secondary" type="reset">되돌리기</button>
              <button class="btn btn-success" onclick="noticeUpdate()" type="button">수정하기</button>
            </div>
            <div>
              <button class="btn btn-dark" onclick="goList()" type="button">목록보기</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </section>
</div>
<script>
  $(document).ready(function () {
    $('#upload_file').hide();
    $('#uploadOn').on("click", function () {
      $('#upload_file').show();
    });
  });

  function validation() {
    if (!$('input:radio[name="board_status"]').is(':checked')) {
      $("#flexCheck01").addClass("is-invalid");
      $("#flexCheck01").focus();
      return false;
    } else if ($("#title").val() == "") {
      $("#title").addClass("is-invalid");
      $("#title").focus();
      return false;
    } else if ($("#content").val().trim() == "") {
      $("#content").addClass("is-invalid");
      $("#content").focus();
      return false;
    } else {
      return true;
    }
  }

  function noticeUpdate() {
    if (validation()) {
      if (confirm("해당내용으로 수정하시겠습니까?")) {
        var form = $('#info_form');
        form.submit();
      } else {
        return false;
      }
    }
  };

  function downloadFileNew(fileName,fileNameOri) {
		if(fileName == ""){
			alert("등록된 파일이 없습니다");
		}else {
			location.href = "/IMJOB/Lists/downloadFileNew?fileName=" + fileName + "&fileNameOri=" + fileNameOri;
		}
  };

  function goList() {
    history.back();
  };
</script>